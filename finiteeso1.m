function zhd = finiteeso1(r)
z1=[r(1);r(2);r(3);r(4);r(5)];
z2=[r(6);r(7);r(8);r(9);r(10)];
y=[r(11);r(12);r(13);r(14);r(15)];
u=[r(16);r(17);r(18);0;0];

mt=1140.7556;
j0=10215;
m=500;
bta=40;
bx=50;
bl=30;
btx=15;
bty=15;
g=9.81;

ta=y(1);
x=y(2);
l=y(3);
tx=y(4);
ty=y(5);


dta=z2(1);
dx=z2(2);
dl=z2(3);
dtx=z2(4);
dty=z2(5);
k1=0.75;
k11=0.75;
k12=0.75;
alpha1=0.8;

m11=j0+m*x^2+mt*x^2+m*l^2-m*l^2*cos(tx)^2*cos(ty)^2+2*m*x*l*cos(ty)*sin(tx);
m12=-m*l*sin(ty);
m13=m*x*sin(ty);
m14=-m*l^2*cos(tx)*cos(ty)*sin(ty);
m15=m*l^2*sin(tx)+m*x*l*cos(ty);
m21=-m*l*sin(ty);
m22=mt+m;
m23=m*cos(ty)*sin(tx);
m24=m*l*cos(tx)*cos(ty);
m25=-m*l*sin(tx)*sin(ty);
m31=m*x*sin(ty);
m32=m*cos(ty)*sin(tx);
m33=m;
m34=0;
m35=0;
m41=-m*l^2*cos(tx)*cos(ty)*sin(ty);
m42=m*l*cos(tx)*cos(ty);
m43=0;
m44=m*l^2*cos(ty)^2;
m45=0;
m51=m*l^2*sin(tx)+m*x*l*cos(ty);
m52=-m*l*sin(tx)*sin(ty);
m53=0;
m54=0;
m55=m*l^2;
M=[m11 m12 m13 m14 m15;m21 m22 m23 m24 m25;m31 m32 m33 m34 m35;m41 m42 m43 m44 m45;m51 m52 m53 m54 m55];

c11=bta+m*x*dx+mt*x*dx+m*l*cos(ty)*sin(tx)*dx+m*l*dl-m*l*cos(tx)^2*cos(ty)^2*dl+m*x*cos(ty)*sin(tx)*dl+m*l^2*cos(tx)*cos(ty)^2*sin(tx)*dtx+m*l*x*cos(tx)*cos(ty)*dtx+m*l^2*cos(tx)^2*cos(ty)*sin(ty)*dty-m*x*l*sin(tx)*sin(ty)*dty;
c12=m*x*dta+mt*x*dta+m*l*cos(ty)*sin(tx)*dta;
c13=m*l*dta-m*l*cos(tx)^2*cos(ty)^2*dta+m*x*cos(ty)*sin(ty)*dta-m*l*cos(tx)*cos(ty)*sin(ty)*dtx+m*x*cos(ty)*dty+m*l*sin(tx)*dty;
c14=m*l^2*cos(tx)*cos(ty)^2*sin(ty)*dta+m*x*l*cos(tx)*cos(ty)*dta-m*l*cos(tx)*cos(ty)*sin(ty)*dl+m*l^2*cos(ty)*sin(tx)*sin(ty)*dtx+m*l^2*cos(tx)*dty-m*l^2*cos(tx)*cos(ty)^2*dty;
c15=m*l^2*cos(tx)^2*cos(ty)*sin(ty)*dta-m*x*l*sin(tx)*sin(ty)*dta+m*x*cos(ty)*dl+m*l*sin(tx)*dl+m*l^2*cos(tx)*dtx-m*l^2*cos(tx)*cos(ty)^2*dtx-m*x*l*sin(ty)*dty;
c21=-m*x*dta-mt*x*dta-m*l*cos(ty)*sin(tx)*dta-m*sin(ty)*dl-m*l*cos(ty)*dty;
c22=bx;
c23=-m*sin(ty)*dta+m*cos(tx)*cos(ty)*dtx-m*sin(tx)*sin(ty)*dty;
c24=m*cos(ty)*cos(tx)*dl-m*l*cos(ty)*sin(tx)*dtx-m*l*cos(tx)*sin(ty)*dty;
c25=-m*l*cos(ty)*dta-m*sin(tx)*sin(ty)*dl-m*l*cos(tx)*sin(ty)*dtx-m*l*cos(ty)*sin(tx)*dty;
c31=-m*l*dta+m*l*cos(tx)^2*cos(ty)^2*dta-m*x*cos(ty)*sin(tx)*dta+m*sin(ty)*dx+m*l*cos(tx)*cos(ty)*sin(ty)*dtx-m*l*sin(tx)*dty;
c32=m*sin(ty)*dta;
c33=bl;
c34=m*l*cos(tx)*cos(ty)*sin(ty)*dta-m*l*cos(ty)^2*dtx;
c35=-m*l*sin(tx)*dta-m*l*dty;
c41=-m*l^2*cos(tx)*cos(ty)^2*sin(tx)*dta-m*x*l*cos(tx)*cos(ty)*dta-m*l*cos(tx)*cos(ty)*sin(ty)*dl-m*l^2*cos(tx)*cos(ty)^2*dty;
c42=0;
c43=-m*l*cos(tx)*cos(ty)*sin(ty)*dta+m*l*cos(ty)^2*dtx;
c44=btx+m*l*cos(ty)^2*dl-m*l^2*cos(ty)*sin(ty)*dty;
c45=-m*l^2*cos(tx)*cos(ty)^2*dta-m*l^2*cos(ty)*sin(ty)*dtx;
c51=-m*l^2*cos(tx)^2*cos(ty)*sin(ty)*dta+m*l*x*sin(tx)*sin(ty)*dta+m*l*cos(ty)*dx+m*l*sin(tx)*dl+m*l^2*cos(tx)*cos(ty)^2*dtx;
c52=m*l*cos(ty)*dta;
c53=m*l*dty+m*l*sin(tx)*dta;
c54=m*l^2*cos(tx)*cos(ty)^2*dta+m*l^2*cos(ty)*sin(ty)*dtx;
c55=bty+m*l*dl;
C=[c11 c12 c13 c14 c15;c21 c22 c23 c24 c25;c31 c32 c33 c34 c35;c41 c42 c43 c44 c45;c51 c52 c53 c54 c55];

g1=0;
g2=0;
g3=-m*g*cos(tx)*cos(ty);
g4=m*g*l*cos(ty)*sin(tx);
g5=m*g*l*cos(tx)*sin(ty);
G=[g1;g2;g3;g4;g5];

M1h=inv(M)*(-C*z2-G)+inv(M)*u;
Mz1h=[z2;M1h];
N11=k11*(z1-y).^(alpha1);
N12=k12*(z1-y).^(2*alpha1-1)+k12*(z1-y).^alpha1;
N1=[N11;N12];
N1N1=k11*(z1-y);
N1N2=k12*(z1-y)+k12*(z1-y).^alpha1;
N1N=[N1N1;N1N2];
Xhd=Mz1h-k1*N1-(1-k1)*N1N;
z1hd=[Xhd(1);Xhd(2);Xhd(3);Xhd(4);Xhd(5)];
z2hd=[Xhd(6);Xhd(7);Xhd(8);Xhd(9);Xhd(10)];
zhd=[z1hd;z2hd];
end