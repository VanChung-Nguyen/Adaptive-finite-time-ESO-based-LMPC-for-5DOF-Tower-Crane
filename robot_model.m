function z_out = robot_model(x,u)
mt=1140.7556;
j0=10215;
m=500;
bta=40;
bxt=50;
bl=30;
bphi=15;
btheta=15;
g=9.81;

ta=x(6);
xt=x(7);
l = x(8);
phi = x(9);
theta = x(10);
dta = x(1);
dxt = x(2);
dl=x(3);
dphi=x(4);
dtheta=x(5);
q=[ta;xt;l;phi;theta];
dq=[dta;dxt;dl;dphi;dtheta];
torta=u(1);
fx=u(2);
fl=u(3);
F=[torta;fx;fl;0;0];

m11=j0+m*xt^2+mt*xt^2+m*l^2-m*l^2*cos(phi)^2*cos(theta)^2+2*m*xt*l*cos(theta)*sin(phi);
m12=-m*l*sin(theta);
m13=m*xt*sin(theta);
m14=-m*l^2*cos(phi)*cos(theta)*sin(theta);
m15=m*l^2*sin(phi)+m*xt*l*cos(theta);
m21=-m*l*sin(theta);
m22=mt+m;
m23=m*cos(theta)*sin(phi);
m24=m*l*cos(phi)*cos(theta);
m25=-m*l*sin(phi)*sin(theta);
m31=m*xt*sin(theta);
m32=m*cos(theta)*sin(phi);
m33=m;
m34=0;
m35=0;
m41=-m*l^2*cos(phi)*cos(theta)*sin(theta);
m42=m*l*cos(phi)*cos(theta);
m43=0;
m44=m*l^2*cos(theta)^2;
m45=0;
m51=m*l^2*sin(phi)+m*xt*l*cos(theta);
m52=-m*l*sin(phi)*sin(theta);
m53=0;
m54=0;
m55=m*l^2;
M=[m11 m12 m13 m14 m15;m21 m22 m23 m24 m25;m31 m32 m33 m34 m35;m41 m42 m43 m44 m45;m51 m52 m53 m54 m55];
c11=bta+m*xt*dxt+mt*xt*dxt+m*l*cos(theta)*sin(phi)*dxt+m*l*dl-m*l*cos(phi)^2*cos(theta)^2*dl+m*xt*cos(theta)*sin(phi)*dl+m*l^2*cos(phi)*cos(theta)^2*sin(phi)*dphi+m*l*xt*cos(phi)*cos(theta)*dphi+m*l^2*cos(phi)^2*cos(theta)*sin(theta)*dtheta-m*xt*l*sin(phi)*sin(theta)*dtheta;
c12=m*xt*dta+mt*xt*dta+m*l*cos(theta)*sin(phi)*dta;
c13=m*l*dta-m*l*cos(phi)^2*cos(theta)^2*dta+m*xt*cos(theta)*sin(theta)*dta-m*l*cos(phi)*cos(theta)*sin(theta)*dphi+m*xt*cos(theta)*dtheta+m*l*sin(phi)*dtheta;
c14=m*l^2*cos(phi)*cos(theta)^2*sin(theta)*dta+m*xt*l*cos(phi)*cos(theta)*dta-m*l*cos(phi)*cos(theta)*sin(theta)*dl+m*l^2*cos(theta)*sin(phi)*sin(theta)*dphi+m*l^2*cos(phi)*dtheta-m*l^2*cos(phi)*cos(theta)^2*dtheta;
c15=m*l^2*cos(phi)^2*cos(theta)*sin(theta)*dta-m*xt*l*sin(phi)*sin(theta)*dta+m*xt*cos(theta)*dl+m*l*sin(phi)*dl+m*l^2*cos(phi)*dphi-m*l^2*cos(phi)*cos(theta)^2*dphi-m*xt*l*sin(theta)*dtheta;
c21=-m*xt*dta-mt*xt*dta-m*l*cos(theta)*sin(phi)*dta-m*sin(theta)*dl-m*l*cos(theta)*dtheta;
c22=bxt;
c23=-m*sin(theta)*dta+m*cos(phi)*cos(theta)*dphi-m*sin(phi)*sin(theta)*dtheta;
c24=m*cos(theta)*cos(phi)*dl-m*l*cos(theta)*sin(phi)*dphi-m*l*cos(phi)*sin(theta)*dtheta;
c25=-m*l*cos(theta)*dta-m*sin(phi)*sin(theta)*dl-m*l*cos(phi)*sin(theta)*dphi-m*l*cos(theta)*sin(phi)*dtheta;
c31=-m*l*dta+m*l*cos(phi)^2*cos(theta)^2*dta-m*xt*cos(theta)*sin(phi)*dta+m*sin(theta)*dxt+m*l*cos(phi)*cos(theta)*sin(theta)*dphi-m*l*sin(phi)*dtheta;
c32=m*sin(theta)*dta;
c33=bl;
c34=m*l*cos(phi)*cos(theta)*sin(theta)*dta-m*l*cos(theta)^2*dphi;
c35=-m*l*sin(phi)*dta-m*l*dtheta;
c41=-m*l^2*cos(phi)*cos(theta)^2*sin(phi)*dta-m*xt*l*cos(phi)*cos(theta)*dta-m*l*cos(phi)*cos(theta)*sin(theta)*dl-m*l^2*cos(phi)*cos(theta)^2*dtheta;
c42=0;
c43=-m*l*cos(phi)*cos(theta)*sin(theta)*dta+m*l*cos(theta)^2*dphi;
c44=bphi+m*l*cos(theta)^2*dl-m*l^2*cos(theta)*sin(theta)*dtheta;
c45=-m*l^2*cos(phi)*cos(theta)^2*dta-m*l^2*cos(theta)*sin(theta)*dphi;
c51=-m*l^2*cos(phi)^2*cos(theta)*sin(theta)*dta+m*l*xt*sin(phi)*sin(theta)*dta+m*l*cos(theta)*dxt+m*l*sin(phi)*dl+m*l^2*cos(phi)*cos(theta)^2*dphi;
c52=m*l*cos(theta)*dta;
c53=m*l*dtheta+m*l*sin(phi)*dta;
c54=m*l^2*cos(phi)*cos(theta)^2*dta+m*l^2*cos(theta)*sin(theta)*dphi;
c55=btheta+m*l*dl;
C=[c11 c12 c13 c14 c15;c21 c22 c23 c24 c25;c31 c32 c33 c34 c35;c41 c42 c43 c44 c45;c51 c52 c53 c54 c55];
g1=0;
g2=0;
g3=-m*g*cos(phi)*cos(theta);
g4=m*g*l*cos(theta)*sin(phi);
g5=m*g*l*cos(phi)*sin(theta);
G=[g1;g2;g3;g4;g5];
ddq=inv(M)*(F-C*dq-G);
ddta=ddq(1);
ddxt=ddq(2);
ddl=ddq(3);
ddphi=ddq(4);
ddtheta=ddq(5);
z_out=[ddta;ddxt;ddl;ddphi;ddtheta;dta;dxt;dl;dphi;dtheta];
end